Please refer to comments in the code for assumptions made
